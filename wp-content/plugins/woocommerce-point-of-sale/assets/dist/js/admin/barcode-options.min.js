"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}jQuery(document).ready(function(m){var r={init:function(){m("#edit_wc_pos_barcode").on("click",".edit-order-item",this.edit_item).on("click",".delete-order-item",this.delete_item).on("click",".cancel-action",this.cancel_action).on("click",".save-action",this.save_action).on("click","tr.item",this.select_row).on("click","tr.item :input, tr.item a",this.select_row_child).on("click","button.add-line-item",this.add_item).on("click","button.add-line-item-category",this.add_category_items).on("click","button.bulk-add-variations",this.add_item_variations).on("click","button.bulk-delete-items",this.bulk_delete_items).on("click",".meta_removable button",this.remove_attributes),m(document.body).append('<div id="printable_barcode"></div>').on("change",".fields_to_print",this.fields_to_print).on("click","#add_products",this.add_products).on("click",".modal-close",this.modal_close).on("click","#print_barcode",this.print_barcodes).on("change","#label_type",this.label_type_options),m(document.body).find("#label_type").trigger("change")},print_barcodes:function(){if(!m("#edit_wc_pos_barcode #order_line_items tr.item").length)return!1;var e=m("#label_type").val(),r=parseInt(m("#number_of_labels").val());(isNaN(r)||r<1)&&(r=1),m("#printable_barcode").html("");var _=[];m("#edit_wc_pos_barcode #order_line_items tr").each(function(e,t){var o=parseInt(m(t).find("td.quantity .quantity").val()),a=r;!isNaN(o)&&1<o&&(a=o);for(var s=0;s<a;s++)_.push(m(t).find(".barcode_border").clone())});var t="";switch(e){case"continuous_feed":m("#printable_barcode").addClass("continuous_feed"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("a4").removeClass("letter").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"continuous_feed_custom":m("#printable_barcode").addClass("continuous_feed_custom"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");var o=m("#label_margin_unit").val(),a=m("#label_margin_top").val(),s=m("#label_margin_bottom").val(),i=m("#label_margin_left").val(),n=m("#label_margin_right").val(),t="\n                    <style>\n                        #printable_barcode .barcode_border { \n                            padding-top: ".concat(a).concat(o,";\n                            padding-bottom: ").concat(s).concat(o,";\n                            padding-left: ").concat(i).concat(o,";\n                            padding-right: ").concat(n).concat(o,";\n                        }\n                    </style>\n                    ");break;case"a4":m("#printable_barcode").addClass("a4"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("letter").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"letter":m("#printable_barcode").addClass("letter"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"per_sheet_30":m("#printable_barcode").addClass("per_sheet_30"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_80").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"per_sheet_80":m("#printable_barcode").addClass("per_sheet_80"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"a4_30":m("#printable_barcode").addClass("a4_30"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("per_sheet_80").removeClass("a4_27").removeClass("con_25_54");break;case"con_4_3":m("#printable_barcode").addClass("con_4_3"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("per_sheet_80").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"con_4_2":m("#printable_barcode").addClass("con_4_2"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_3").removeClass("per_sheet_80").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"jew_50_10":m("#printable_barcode").addClass("jew_50_10"),m("#printable_barcode").removeClass("con_4_2").removeClass("con_4_3").removeClass("per_sheet_80").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27").removeClass("con_25_54");break;case"a4_27":m("#printable_barcode").addClass("a4_27"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("per_sheet_80").removeClass("a4_30").removeClass("con_25_54");break;case"con_25_54":m("#printable_barcode").addClass("con_25_54"),m("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed_custom").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("per_sheet_80").removeClass("a4_30").removeClass("a4_27")}m("#printable_barcode").append(_);var d=window.open("","","left=0,top=0,width=800,height=800,toolbar=0,scrollbars=0,status=0");d.document.write("<html>"),d.document.write('<head><link rel="stylesheet" href="'.concat(window.wc_pos_barcode.print_css_url,'" /></head>')),d.document.write("<body>"+m("#printable_barcode").prop("outerHTML")+t+"</body>"),d.document.write("</html>"),d.document.close(),d.focus(),setTimeout(function(){d.print(),d.close()},500)},label_type_options:function(e){"continuous_feed_custom"===e.target.value?m("#continous_feed_custom_options").show():m("#continous_feed_custom_options").hide()},fields_to_print:function(){var r=m("#field_barcode").is(":checked"),_=m("#field_sku").is(":checked"),i=m("#field_sku_label").is(":checked"),n=m("#field_name").is(":checked"),d=m("#field_price").is(":checked"),c=m("#field_meta_value").is(":checked"),l=m("#field_meta_title").is(":checked");m("#order_line_items .item").each(function(e,t){var o,a=m(t).find(".barcode_border .barcode_text"),s=m(t).find(".barcode_border img").data("barcode_url");a.html(""),r?m(t).find(".barcode_border img").show().attr("src",s+"&font_size=0"):m(t).find(".barcode_border img").hide(),_&&(s=m(t).find(".sku_text").text(),a.append(s=i?'<span class="barcode_sku">SKU: '+s+"</span>":s).append("<br />")),n&&(o=m(t).find(".wc-order-item-name").text(),a.append(o='<span class="barcode_name">'+o+"</span>")),d&&(o=m(t).find(".product_price").text(),a.append(o='<span class="barcode_amount">'+o+"</span>")),c&&(t=m(t).find(".display_meta tr"),m.each(t,function(e,t){var o="";l&&(o=m(t).find("th").text()+"&nbsp;"),o+=m(t).find("td").text(),a.append(o='<span class="meta_removable">'+o+" <button></button></span>").append("<br />")}))})},modal_close:function(){return m("#add_item_id").select2("destroy"),m("#wc-pos-barcode-modal-dialog").remove(),!1},init_tiptip:function(){m("#tiptip_holder").removeAttr("style"),m("#tiptip_arrow").removeAttr("style"),m(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},block:function(){m("#edit_wc_pos_barcode").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){m("#edit_wc_pos_barcode").unblock()},edit_item:function(){var e=m(this).closest("tr");e.addClass("editing"),m(this).hide(),e.find("td.quantity .view").hide(),e.find("td.quantity .edit").show();var t=e.find("td.quantity .quantity").val();return e.find("td.quantity .quantity").data("qty",t),m(".wc-order-bulk-actions .barcode-edit-item").show(),!1},delete_item:function(){var e,t=parseInt(m(this).closest("tr").data("parentid"));return m(this).closest("tr").remove(),m("#tiptip_holder").hide(),m("#edit_wc_pos_barcode #order_line_items tr").length?(e=m('table.woocommerce_order_items tbody#order_line_items tr[data-parentid="'+t+'"]'),m('table.woocommerce_order_items tbody#order_line_items tr[data-prid="'+t+'"]').length||e.removeClass("variation_row")):(e=m("#wc_pos_barcode_no_products").html(),m("#edit_wc_pos_barcode #order_line_items").html(e)),!1},cancel_action:function(){var e=m("#edit_wc_pos_barcode tr.editing");return e.removeClass("editing"),e.find(".edit-order-item").removeAttr("style"),e.find("td.quantity .view").show(),e.find("td.quantity .edit").hide(),m(".wc-order-bulk-actions .barcode-edit-item").hide(),e.each(function(e,t){var o=m(t).find("td.quantity .quantity").data("qty");m(t).find("td.quantity .quantity").val(o),m(t).find("td.quantity .view span").text(o)}),!1},save_action:function(){return m("#edit_wc_pos_barcode tr.editing").each(function(e,t){var o=m(t).find("td.quantity .quantity").val();m(t).find("td.quantity .quantity").data("qty",o)}),r.cancel_action(),!1},select_row:function(){var e=!1,e=m(this).is("tr")?m(this):m(this).closest("tr"),t=m(this).closest("table");e.is(".selected")?e.removeClass("selected"):e.addClass("selected");var o,t=t.find("tr.selected");t.length?(m(".bulk-delete-items").show(),o=!1,t.each(function(){m(this).is("tr.variable")&&(o=!0)}),o?m(".bulk-add-variations").show():m(".bulk-add-variations").hide()):m(".bulk-delete-items, .bulk-add-variations").hide()},select_row_child:function(e){e.stopPropagation()},add_item:function(){var o,e=m("#wc_pos_modal_barcode_add_products").html();return m("body").append(e),m("#order_line_items tr.item").length&&(o=[],m("#order_line_items tr.item").each(function(e,t){t=parseInt(m(t).data("prid"));o.push(t)}),m("#add_item_id").data("exclude",o.join(","))),m(document.body).trigger("wc-enhanced-select-init"),!1},add_category_items:function(){var e=m("#wc_pos_modal_barcode_add_products").html();return m("body").append(e),m("#add_item_id").data("action","wc_pos_json_search_categories").attr("data-placeholder",wc_pos_barcode.select_placeholder_category).addClass("search_categories"),m(document.body).trigger("wc-enhanced-select-init"),!1},bulk_delete_items:function(){var e=m("table.woocommerce_order_items").find("tr.selected");return e.length&&window.confirm(wc_pos_barcode.remove_item_notice)&&(e.find("a.delete-order-item").click(),m(".bulk-delete-items, .bulk-add-variations").hide()),!1},add_products:function(){var e,t;e=3<=wc_pos_params.wc_version?m("#add_item_id").val():m("#add_item_id").val().split(","),m("#add_item_id").hasClass("search_categories")?(r.block(),r.modal_close(),t={action:"wc_pos_get_products_by_categories",categories:e,security:wc_pos_barcode.product_for_barcode_nonce},m.post(wc_pos_barcode.ajax_url,t,function(e){e="object"!==_typeof(e)?jQuery.parseJSON(e):e;r.add_items(e)})):r.add_items(e)},add_items:function(e){var s;void 0!==e&&e&&(s=e.length,r.block(),r.modal_close(),m.each(e,function(e,a){var t;m("table.woocommerce_order_items tbody#order_line_items .item_"+a).length?--s||(r.fields_to_print(),r.init_tiptip(),r.unblock()):(t={action:"wc_pos_add_product_for_barcode",item_to_add:a,security:wc_pos_barcode.product_for_barcode_nonce},m.post(wc_pos_barcode.ajax_url,t,function(e){m("table.woocommerce_order_items tbody#order_line_items .no_products").remove();var t=m(e),o=parseInt(t.data("parentid")),t=m('table.woocommerce_order_items tbody#order_line_items tr[data-parentid="'+o+'"]');NaN!=o&&null!=o&&t.length?(a==o?t.first().before(e):t.last().after(e),(t=m('table.woocommerce_order_items tbody#order_line_items tr[data-parentid="'+o+'"]')).removeClass("variation_row"),m('table.woocommerce_order_items tbody#order_line_items tr[data-prid="'+o+'"]').length&&t.filter(".variation").addClass("variation_row")):m("table.woocommerce_order_items tbody#order_line_items").append(e),--s||(r.fields_to_print(),r.init_tiptip(),r.unblock())}))}))},add_item_variations:function(){var e=m("table.woocommerce_order_items").find("tr.variable.selected"),o=[];e.length&&(r.block(),e.each(function(e,t){t=parseInt(m(t).data("prid"));o.push(t)}),e={action:"wc_pos_get_product_variations_for_barcode",prid:o,security:wc_pos_barcode.product_for_barcode_nonce},m.post(wc_pos_barcode.ajax_url,e,function(e){e="object"!==_typeof(e)?jQuery.parseJSON(e):e;r.add_items(e)}))},remove_attributes:function(){var e=m(this).parent("span");e.next("br").remove(),e.remove()}};r.init()});